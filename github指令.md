[TOC]

# github 指令介绍

## git的原理

Git的核心是对象数据库，其中三类核心的对象为：

- **blob对象：**实现对文件内容的记录；对象保存在.git/objects； 

- **tree对象：**实现对文件名，文件结构的记录以及变更过程；对象保存在暂存区.git/index文件中

- **commit对象：**实现对版本提交时间，作者信息，版本说明的记录；

  

## github 提交代码

### 上传代码的三个步骤

```git
git add filename
git commit -m 'detail'
git push
```

### github的分区管理与代码上传

git以分区的形式管理文件，主要是两大分区：

**工作区：**即当前的工作路径，保存着自己写的代码

**版本库：**在当前工作区下有一个隐藏的文件夹.git，这边是git的版本库，实现版本的管理。

版本库中存了很多东西，其中最重要的是stage（index暂存区），还有git为我们自动生成的第一个分支master，以及指向当前分支的HEAD指针。

工作区与版本库之间的关系如下图：

<img src="./images/github_1.png" style="zoom:50%;" />

因此代码提交的步骤可以看成：

1. git add filename： 将文件从工作区提交到暂存区(index)中
2. git commit -m "note" ： 将文件从暂存区提交到当前head指向的分支上
3. git push将当前分支提交到服务器上

**为什么要有暂存区：**一个说法是，我们可以一个个的修改文件，然后一次性commit到当前分支上，比较有灵活性。因为有些修改我们可能不希望提交。

### 查看代码状态 git status

git status可以查看：

1. 当前工作区文件是否被追踪，是否存在文件修改没有提交到暂存区上。
2. 暂存区文件是否与当前分支文件内容不一样，是否存在需要commit的文件
3. 提示你本分支的文件与服务器是否不同，如果不同的话，提示你push到服务器上

#### git diff参数：

1. 不带参数：如果index不为空，对比工作区和index，如果index为空则对比工作区和commit
2. git diff branch1 branch2  对比不同分支的不同（-stat 仅列出不同文件）
3. git diff HEAD 比较工作区与最新的版本库

git status的输出不是很好看懂，下面介绍一下：

git将不同文件合并输出,其中- 符号后面的内容是历史文件。+ 则是工作区的文件。这是他们之间的不同。



## 版本控制

### 查看历史记录

```git 
git log # 查询历史的提交记录（主要是作者信息）
git reflog # 查询历史的提交记录，主要是提交行为，找到对应的hash，可用于版本的回退
```

###git 版本回退

```
git reset --hard HEAD~1 # 回退到上一个版本
git reset --hard HEAD~2 # 回退到倒数第二个版本
```

当我们使用hard参数，将彻底的返回到上一个版本，如果我们后悔了，想要回到未来的版本。有一个做法是，找到未来版本的hash码，然后：

```
git reset --hard 哈希码
```

如果我们找不到哈希码，可以通过：

```
git reflog
```

指令找回我们所有的提交指令，然后找到对应的哈希码。

### git 撤销修改

场景1：当你改乱了工作区某个文件的内容，想直接丢弃工作区的修改时，用命令

```
git checkout -- file_name
```

场景2：当你不但改乱了工作区某个文件的内容，还添加到了暂存区时，想丢弃修改，分两步，第一步用命令

```
git reset HEAD <file_name>
```

就回到了场景1，第二步按场景1操作。

### 删除文件

#### 删除文件

当我们需要删除一个文件时，在工作区直接：

```
rm file_name 
```

但是这个时候版本库里头的文件还存在，这时候用命令：

```
git rm file_name
```

即可同步。

#### 误删恢复

当我们发生了误删之后，执行：

```
git checkout -- file_name 
```

即可恢复。git checkout这个方法的作用是用版本库的文件来替代工作区的文件。注意中间有一个 --符号。 

